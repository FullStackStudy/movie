  <!DOCTYPE html>
  <html xmlns:th="http://www.thymeleaf.org">
  <head>
    <title>ğŸ’³ê²°ì œ í˜ì´ì§€</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
      body {
   background-color: #144C3B;
   font-family: 'Pretendard', sans-serif;
   margin: 0;
   padding: 0;
 }

 .payment-container {
   background-color: #144C3B;
   border-radius: 24px;
   padding: 3rem;
   margin: 2rem auto;
   max-width: 800px;
   color: #FFE066;
   box-shadow: 0 10px 40px rgba(0, 0, 0, 0.25);
   border: 2px solid #FFE066;
 }

 .payment-container h2 {
   text-align: center;
   font-size: 2.5rem;
   font-weight: bold;
   margin-bottom: 2rem;
   color: #FFE066;
   border-bottom: 3px solid #FFE066;
   padding-bottom: 1rem;
 }

 .info-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); /* â† ë‘ ì¹¸ */
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.info-item {
  background-color: #103b30;
  color: #FFE066;
  border-left: 4px solid #FFE066;
  border-radius: 12px;
  padding: 1rem 1.2rem;
  font-size: 0.95rem;
  font-weight: 500;
  text-align: left;
  display: flex;
  flex-direction: column;
  gap: 0.3rem;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.info-item p {
  margin: 0;
}

.label {
  font-weight: bold;
}

.value {
  font-weight: normal;
}

 .final-price {
   background-color: #FFE066;
   color: #144C3B;
   font-size: 1.5rem;
   font-weight: bold;
   padding: 1.5rem;
   border-radius: 20px;
   text-align: center;
   margin-bottom: 2rem;
 }

 .payment-btn,
 button[type="button"] {
   display: block;
   width: 100%;
   padding: 1rem;
   font-size: 1.2rem;
   font-weight: bold;
   border: none;
   border-radius: 30px;
   transition: background-color 0.3s ease, transform 0.2s;
   cursor: pointer;
   background-color: #FFE066;
   color: #144C3B;
   margin-top: 1rem;
 }

 .payment-btn:hover,
 button[type="button"]:hover {
   background-color: #f0d34d;
   transform: translateY(-3px);
 }

 @media (max-width: 768px) {
   .payment-container {
     padding: 2rem;
     margin: 1rem;
   }

   .payment-container h2 {
     font-size: 2rem;
   }

   .info-grid {
     grid-template-columns: 1fr;
   }

   .payment-btn {
     font-size: 1rem;
   }
 }

    </style>
    <script src="https://cdn.iamport.kr/js/iamport.payment-1.2.0.js"></script>
    <script th:inline="javascript">
      const IMP = window.IMP;
      IMP.init("imp21428454");

      function requestPay() {
        const form = document.getElementById('paymentForm');

        const itemName = [[${storePaymentInfo.items[0].itemNm}]] +
          ([[${storePaymentInfo.items.size()}]] > 1 ? ' ì™¸ ' + ([[${storePaymentInfo.items.size()}]] - 1) + 'ê±´' : '');
        const amount = [[${storePaymentInfo.amount}]];
        const memberId = [[${storePaymentInfo.memberId}]];

        IMP.request_pay({
          pg: "html5_inicis",
          pay_method: "card",
          merchant_uid: "mid_" + new Date().getTime(),
          name: itemName,
          amount: amount,
          buyer_name: memberId
        }, function (rsp) {
          if (rsp.success) {
            document.getElementById("impUid").value = rsp.imp_uid;
            document.getElementById("merchantUid").value = rsp.merchant_uid;
            form.submit();
          } else {
            alert("âŒ ê²°ì œ ì‹¤íŒ¨: " + rsp.error_msg);
          }
        });
      }
    </script>
  </head>
  <body>
  <div class="payment-container">
    <h2> ê²°ì œ ì •ë³´ í™•ì¸</h2>

    <div class="payment-info">
      <h3> ìƒí’ˆ ì •ë³´</h3>
      <!-- ìƒí’ˆ ì •ë³´ ë°˜ë³µ -->
      <div class="info-grid" th:if="${#lists.isEmpty(storePaymentInfo.items)} == false">
        <div th:each="item : ${storePaymentInfo.items}" class="info-item">
        <p><span class="label">ìƒí’ˆ</span>: <span class="value" th:text="${item.itemNm}"></span></p>
        <p><span class="label">êµ¬ì„±</span>: <span class="value" th:text="${item.itemComposition}"></span></p>
        <p><span class="label">ìˆ˜ëŸ‰</span>: <span class="value" th:text="${item.quantity}"></span></p>
        <p><span class="label">ê°€ê²©</span>: <span class="value" th:text="${item.price} + 'ì›'"></span></p>
        <p><span class="label">í”½ì—… ì‹œê°„</span>: <span class="value" th:text="${item.pickupTime}"></span></p>
        <p><span class="label">ì˜í™”ê´€</span>: <span class="value" th:text="${item.cinemaName}"></span></p>
        </div>
      </div>
      <div class="final-price">
         ì´ ê²°ì œê¸ˆì•¡: <span th:text="${storePaymentInfo.amount}"></span>ì›
      </div>
        <form id="paymentForm" th:action="@{/store/payment/verify}" method="post">
        <input type="hidden" name="memberId" th:value="${storePaymentInfo.memberId}">
        <input type="hidden" id="impUid" name="impUid">
        <input type="hidden" id="merchantUid" name="merchantUid">

        <!-- ë°˜ë³µì ìœ¼ë¡œ ìƒí’ˆ í•­ëª©ì„ formìœ¼ë¡œ ì „ì†¡ -->
        <div th:each="item, iterStat : ${storePaymentInfo.items}">
          <input type="hidden" th:name="'items[' + ${iterStat.index} + '].itemNm'" th:value="${item.itemNm}">
          <input type="hidden" th:name="'items[' + ${iterStat.index} + '].itemComposition'" th:value="${item.itemComposition}">
          <input type="hidden" th:name="'items[' + ${iterStat.index} + '].quantity'" th:value="${item.quantity}">
          <input type="hidden" th:name="'items[' + ${iterStat.index} + '].price'" th:value="${item.price}">
          <input type="hidden" th:name="'items[' + ${iterStat.index} + '].pickupTime'" th:value="${item.pickupTime}">
          <input type="hidden" th:name="'items[' + ${iterStat.index} + '].cinemaName'" th:value="${item.cinemaName}">
        </div>

        <button type="button" onclick="requestPay()">ê²°ì œí•˜ê¸°</button>
      </form>
      </div>
  </div>
  </body>
  </html>